---
phase: 05-solutions-library
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/app/(dashboard)/solutions/page.tsx
  - src/app/(dashboard)/solutions/[productId]/page.tsx
  - src/components/solutions/product-card.tsx
  - src/components/solutions/product-filters.tsx
autonomous: true

must_haves:
  truths:
    - "User can view product catalog as a grid of product cards"
    - "User can filter products by grade range and subject area"
    - "User can search products by name"
    - "User can click a product card and navigate to product detail page"
    - "Product detail page shows full metadata, key features, target challenges, and assets"
  artifacts:
    - path: "src/app/(dashboard)/solutions/page.tsx"
      provides: "Product catalog page with search, filters, and card grid"
      contains: "ProductCard"
    - path: "src/app/(dashboard)/solutions/[productId]/page.tsx"
      provides: "Product detail page with full metadata and asset list"
      contains: "gradeRange"
    - path: "src/components/solutions/product-card.tsx"
      provides: "Product summary card component"
      exports: ["ProductCard"]
    - path: "src/components/solutions/product-filters.tsx"
      provides: "Grade range and subject area filter controls"
      exports: ["ProductFilters"]
  key_links:
    - from: "src/app/(dashboard)/solutions/page.tsx"
      to: "/api/products"
      via: "fetch in useEffect"
      pattern: "fetch.*api/products"
    - from: "src/app/(dashboard)/solutions/[productId]/page.tsx"
      to: "src/services/product-service.ts"
      via: "direct service call (server component)"
      pattern: "getProduct"
    - from: "src/components/solutions/product-card.tsx"
      to: "/solutions/[productId]"
      via: "Link or router.push"
      pattern: "solutions.*productId"
---

<objective>
Build the product catalog browsing UI and product detail page.

Purpose: Users can browse, search, and filter the product catalog, then drill into individual products to see full metadata and associated assets. This is the read-only view available to all authenticated users.

Output: Updated solutions page with catalog grid, filter controls, and a new product detail page.
</objective>

<execution_context>
@/Users/dorenberge/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dorenberge/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-solutions-library/05-01-SUMMARY.md
@src/services/types/product.ts
@src/services/types/controlled-vocabulary.ts
@src/app/(dashboard)/discovery/page.tsx
@src/components/discovery/district-result-card.tsx
@src/components/discovery/search-bar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build product catalog page with filters and card grid</name>
  <files>
    src/app/(dashboard)/solutions/page.tsx
    src/components/solutions/product-card.tsx
    src/components/solutions/product-filters.tsx
  </files>
  <action>
**Create `src/components/solutions/product-filters.tsx`:**

Client component that renders grade range and subject area filter dropdowns.

Props: `{ filters: { gradeRange?: string; subjectArea?: string }; onFiltersChange: (filters) => void }`

- Import GRADE_RANGES and SUBJECT_AREAS from controlled-vocabulary.ts
- Render two `<select>` elements styled with Tailwind:
  - Grade Range: options are "All Grade Ranges" (empty value) + all GRADE_RANGES values
  - Subject Area: options are "All Subject Areas" (empty value) + all SUBJECT_AREAS values
- On change, call onFiltersChange with updated filter object (omit key if empty value selected)
- Style: each select with `w-full rounded-md border border-input bg-background px-3 py-2 text-sm` classes
- Wrap in a flex row with gap-3 for horizontal layout

**Create `src/components/solutions/product-card.tsx`:**

Client component showing a product summary card.

Props: `{ product: ProductSummary }` (import from `@/services/types/product`)

- Card layout: border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer bg-card
- Show: product name (font-semibold text-lg font-heading), description (text-sm text-muted-foreground, truncated to 2 lines with line-clamp-2)
- Bottom row: grade range badge (small rounded pill bg-primary/10 text-primary px-2 py-0.5 text-xs), subject area badge (same style but bg-secondary/10 text-secondary-foreground), asset count if > 0 (e.g., "3 assets" in text-xs text-muted-foreground)
- Entire card is a Link to `/solutions/${product.productId}`
- Use Next.js Link component for navigation

**Update `src/app/(dashboard)/solutions/page.tsx`:**

Convert to 'use client' page. Implement:

- State: searchQuery (string), filters ({ gradeRange?: string, subjectArea?: string }), products (ProductSummary[]), loading (boolean), error (string | null)
- Debounced search: same pattern as discovery page (useEffect + setTimeout 300ms)
- Fetch products from GET /api/products with query params: q, gradeRange, subjectArea
- Reset on filter/search change (trigger fetch)
- Layout:
  - Page header: "Solutions Library" h1 + description text
  - Search input: text input with placeholder "Search products..." (styled same as discovery search bar pattern - w-full rounded-md border px-4 py-2)
  - Below search: ProductFilters component
  - Below filters: grid of ProductCard components (grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4)
  - Loading state: "Loading products..." text
  - Empty state: "No products found." text with suggestion to adjust filters
  - Error state: red error text
  </action>
  <verify>Run `npx tsc --noEmit` and confirm zero TypeScript errors. Verify all 3 files exist.</verify>
  <done>Solutions page renders product catalog with search input, grade range and subject area filter dropdowns, and a responsive grid of product cards. Cards link to product detail pages. Debounced search queries the API. TypeScript compiles cleanly.</done>
</task>

<task type="auto">
  <name>Task 2: Build product detail page</name>
  <files>src/app/(dashboard)/solutions/[productId]/page.tsx</files>
  <action>
Create `src/app/(dashboard)/solutions/[productId]/page.tsx` as a server component (no 'use client') following the district profile page pattern.

**Data fetching:**
- Import getProduct from product-service.ts (direct service call, no API round-trip)
- Import getCurrentUser from auth-utils.ts
- Async server component: call getCurrentUser() to get tenantId, then getProduct(tenantId, productId)
- Params: `{ params }: { params: Promise<{ productId: string }> }`, await params
- If product not found (catch error with code PRODUCT_NOT_FOUND), show "Product not found" message with link back to /solutions

**Layout structure:**

Header section:
- Back link: "< Back to Solutions" linking to /solutions (text-sm text-primary hover:underline)
- Product name as h1 (text-2xl font-semibold font-heading)
- Grade range and subject area badges (same pill style as product card)
- Description paragraph (text-muted-foreground mt-2)

Metadata sections (2-column grid on lg, 1-column on mobile):

Left column - "Product Details" card (border rounded-lg p-6 bg-card):
- Key Features: bulleted list if keyFeatures array has items, else "No key features listed"
- Target Challenges: bulleted list if targetChallenges array has items, else "No target challenges listed"
- Competitive Differentiators: bulleted list if competitiveDifferentiators array has items, else "No differentiators listed"
- Section headings: text-sm font-semibold uppercase tracking-wide text-muted-foreground mb-2

Right column - two cards stacked:

"Approved Messaging" card (border rounded-lg p-6 bg-card):
- Bulleted list of approvedMessaging items, else "No approved messaging"

"Product Assets" card (border rounded-lg p-6 bg-card):
- If assets exist: list each asset showing fileName, fileType badge, fileSize (formatted as KB/MB), and a link/button for the URL
- If no assets: "No assets uploaded yet"
- Asset row: flex items-center justify-between py-2 border-b last:border-0

**Formatting helpers:**
- File size: format bytes to human-readable (e.g., 1024 -> "1.0 KB", 1048576 -> "1.0 MB")
- Create a simple inline helper function formatFileSize(bytes: number): string
  </action>
  <verify>Run `npx tsc --noEmit` and confirm zero TypeScript errors. Verify the page file exists at the correct path.</verify>
  <done>Product detail page renders as server component with direct service call. Shows product name, grade/subject badges, description, key features, target challenges, competitive differentiators, approved messaging, and asset list with file details. Handles not-found gracefully. TypeScript compiles cleanly.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- Solutions page at /solutions shows product catalog with search and filters
- Product card component links to /solutions/[productId]
- Product detail page at /solutions/[productId] renders full metadata
- Grade range and subject area filters use controlled vocabulary values
- Product detail page uses server-side data fetching (no API round-trip)
</verification>

<success_criteria>
Users can browse the product catalog with search and grade/subject filters, view product cards in a responsive grid, and click through to a detailed product page showing all metadata and assets.
</success_criteria>

<output>
After completion, create `.planning/phases/05-solutions-library/05-02-SUMMARY.md`
</output>
